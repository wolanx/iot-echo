package main

import (
	"fmt"
	"math"
	"testing"

	"github.com/zx5435/iot-echo/protocol/crc16"
)

func TestAsd(t *testing.T) {
	//a := 0x429b8a3d // 77.77
	a := 0xa0207439
	fmt.Println(a)

	f := math.Float32frombits(uint32(a))
	fmt.Println(f)
}

func TestZxczxc(t *testing.T) {
	//var a float32 = 77.77 // 429b8a3d
	var a float32 = 79.92126 // 429fd7af
	fmt.Println(a)

	f := math.Float32bits(a)
	fmt.Printf("%x\n", f)
}

func TestCrc(t *testing.T) {
	table := crc16.MakeTable()
	crc := crc16.Checksum([]byte{
		//0x02, 0x07, 0x20, 0x22, 0x25, 0x27, 0x51, 0x98, 0x99,
		0x05, 0x20, 0x01, 0x02, 0x01, 0x3E, // 46 22
		//0x0b, 0xcf, 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x6, 0x7, 0x8, 0x9, 0x0a, 0x0b, 0xc, 0xd, 0xe,
		//0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x6, 0x7, 0x8, 0x9, 0x0a, 0x0b, 0xc, 0xd, 0xe,
		//0x07, 0x20, 0x01, 0x02, 0xC3, 0x02, 0x10, 0x1A, // 90 1c
	}, table)
	fmt.Printf("%x\n", crc)
}

func TestBuildGeniBus(t *testing.T) {
	fmt.Printf("% x\n", BuildGeniBus(0x27, 0x20, 0x01, []byte{0x02, 0x01, 0x3E}))
	fmt.Printf("% x\n", BuildGeniBus(0x27, 0x20, 0x01, []byte{0x02, 0xC3, 0x02, 0x10, 0x1A}))
}
